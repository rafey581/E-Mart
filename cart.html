<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart - E-Mart | Secure Checkout</title>
    <meta name="description"
        content="View your shopping cart at E-Mart. Review your items, proceed to secure checkout, and get free shipping on qualifying orders.">
    <meta name="robots" content="noindex, follow">
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Sora', sans-serif;
        }

        h1,
        h2 {
            font-family: 'Montserrat', sans-serif;
        }
    </style>
</head>

<body class="bg-gray-50 text-gray-800">
    <header class="flex items-center justify-between p-4 border-b border-gray-300 bg-white">
        <a href="index.html">
            <img class="h-16" src="./assets/icons/logo.png" alt="E-Mart Logo"
                onerror="this.onerror=null; this.style.display='none'">
        </a>
        <nav class="hidden md:flex gap-6 text-sm md:text-base font-medium">
            <a class="hover:underline" href="index.html">Home</a>
            <a class="hover:underline" href="index.html#product-container">Shop</a>
        </nav>
        <div class="flex gap-4 items-center">
            <button onclick="toggleDarkMode()" class="p-2 rounded-full hover:bg-gray-100 transition-colors"
                title="Toggle Dark Mode">
                <svg id="theme-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
            </button>
            <a href="whishlist.html" aria-label="Wishlist"><img class="h-8 transition-transform hover:scale-110"
                    src="./assets/icons/heart logo.png" alt="Wishlist"></a>
            <a href="cart.html" aria-label="Cart"><img class="h-8 transition-transform hover:scale-110"
                    src="./assets/icons/cart icon.png" alt="Cart"></a>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold mb-8">Shopping Cart</h1>

        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Cart Items -->
            <div class="flex-grow">
                <div id="cart-container" class="space-y-4">
                    <!-- Items will be loaded here -->
                </div>

                <div id="empty-cart" class="hidden text-center py-20 bg-white rounded-lg shadow-sm">
                    <p class="text-xl text-gray-500 mb-4">Your cart is empty</p>
                    <a href="index.html"
                        class="inline-block bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">Start
                        Shopping</a>
                </div>
            </div>

            <!-- Summary -->
            <div id="cart-summary" class="hidden w-full lg:w-80 h-fit bg-white p-6 rounded-lg shadow-sm">
                <h2 class="text-xl font-bold mb-4">Order Summary</h2>
                <div class="space-y-2 mb-4 border-b pb-4">
                    <div class="flex justify-between">
                        <span class="text-gray-600">Subtotal</span>
                        <span class="font-semibold" id="subtotal-price">Rs.0.00</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Shipping</span>
                        <span class="text-green-600">Free</span>
                    </div>
                </div>
                <div class="flex justify-between mb-6 text-lg font-bold">
                    <span>Total</span>
                    <span id="total-price">Rs.0.00</span>
                </div>
                <button
                    class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition">
                    Checkout
                </button>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('cart-container');
            const emptyMsg = document.getElementById('empty-cart');
            const summary = document.getElementById('cart-summary');
            const subtotalEl = document.getElementById('subtotal-price');
            const totalEl = document.getElementById('total-price');

            function loadCart() {
                const cart = JSON.parse(localStorage.getItem('cart')) || [];

                if (cart.length === 0) {
                    container.classList.add('hidden');
                    summary.classList.add('hidden');
                    emptyMsg.classList.remove('hidden');
                    return;
                }

                container.classList.remove('hidden');
                summary.classList.remove('hidden');
                emptyMsg.classList.add('hidden');

                let total = 0;

                container.innerHTML = cart.map(product => {
                    const itemTotal = product.price * product.quantity;
                    total += itemTotal;

                    return `
                        <div class="flex items-center gap-4 bg-white p-4 rounded-lg shadow-sm">
                            <img src="${product.image || './assets/icons/image.png'}" alt="${product.name}" class="h-24 w-24 object-cover rounded-md">
                            
                            <div class="flex-grow">
                                <h3 class="font-semibold text-lg line-clamp-1">${product.name}</h3>
                                <p class="text-gray-500 text-sm mb-2">${product.brand || ''}</p>
                                <p class="text-blue-600 font-bold">Rs.${product.price.toFixed(2)}</p>
                            </div>
                            
                            <div class="flex flex-col items-end gap-2">
                                <div class="flex items-center gap-2">
                                    <button onclick="updateQuantity(${product.id}, -1)" class="w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center font-bold text-gray-600">-</button>
                                    <span class="w-8 text-center font-medium">${product.quantity}</span>
                                    <button onclick="updateQuantity(${product.id}, 1)" class="w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center font-bold text-gray-600">+</button>
                                </div>
                                <button onclick="removeFromCart(${product.id})" class="text-red-500 text-sm hover:underline">Remove</button>
                            </div>
                        </div>
                    `;
                }).join('');

                subtotalEl.textContent = `Rs.${total.toFixed(2)}`;
                totalEl.textContent = `Rs.${total.toFixed(2)}`;
            }

            window.updateQuantity = (id, change) => {
                let cart = JSON.parse(localStorage.getItem('cart')) || [];
                const item = cart.find(p => p.id === id);

                if (item) {
                    item.quantity += change;
                    if (item.quantity <= 0) {
                        cart = cart.filter(p => p.id !== id);
                    }
                    localStorage.setItem('cart', JSON.stringify(cart));
                    loadCart();
                }
            };

            window.removeFromCart = (id) => {
                let cart = JSON.parse(localStorage.getItem('cart')) || [];
                cart = cart.filter(p => p.id !== id);
                localStorage.setItem('cart', JSON.stringify(cart));
                loadCart();
            };

            loadCart();
        });
    </script>
</body>

</html>